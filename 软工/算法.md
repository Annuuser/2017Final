# 考试安排算法



### 问题描述

假设某院开了n门专业课，m名学生在n门专业课中进行选择，现要求设计考试时间安排，要求尽可能在最短时间内安排完考试，并设计合适的数据结构。



### 解决思考

想要求到尽可能优的值考虑到了贪心算法，也就是从选课最多的人开始考虑。先把选课最多的人的课程安排到不同的时间段，再基于此安排其他的课程。具体流程如下：

1. 找选课最多的学生：找到选课最多的学生，将其所选课程安排一次安排到不同时间段
2. 找选课人数最多的课程：对于已经安排的课程，找到选课人数最多的课程进行分析。
3. 找最容易冲突的时间段：选择该与该课程没有共同选课学生的选课人数最多的课程安排在同一个时间段。
4. 同一时间段考试数量最大化：仍然是相同时间段，选择与当前时间段所有课程都没有冲突的课程添加到对应时间段，并且一次循环此步骤，直到当前时间段没有可以添加的课程
5. 把已经不能添加课程时间段内的所有课程从图中删除，从2中开始重复步骤，直到所有的课程安排完成



### 算法设计

算法等价于着色问题，用一个无向图来保存，点代表课程，两点之间的线段代表有学生同时选择了两门课程

问题转换成了：

1. 有连线的定点不能上同一颜色
2. 要求使用最少的颜色涂满所有顶点

数据结构：

* dgrm邻接矩阵表示无向图信息
* stu_class_num保存每个学生选课数量
* set_cpl保存已经安排好时间且未进行非相邻节点加入的课程集合
* set_deal保存当前正在处理的颜色的课程集合
* set_wt保存当前的候选节点
* set_wt_lst保存上一次的候选节点
* class_time保存排课信息，下标为相应课程，值为排课时间

算法流程：

1. 根据选课信息构建邻接矩阵dgrm，从stu_class_num选择选课人数最多的学生
2. 将该学生所选课程上色，也就是将这些顶点放入已经安排的set_cpl中，set中按照课程的选课人数进行排序
3. 选出set_cpl中选课人数最多的课程为当前处理课程，将当前课程取出，放到set_deal中，构造当前处理颜色的节点集合。
4. 寻找当前课程在图中不相邻的顶点，即是邻接矩阵中对应行或列为0的点，依次遍历，如果节点不在set_cpl和set_deal并集中，则将其放入set_wt。
5. 遍历完成后，如果set_wt不为空，判断如果set_wt_lst不为空则与set_wt_lst做交集，结果存在set_wt作为候选节点集合，进入步骤6；如果set_wt为空则进入步骤7.
6. 选择set_wt中选课人数最多的节点作为当前处理课程，标记与当前处理颜色上相同的颜色，并将该节点放入set_cpl中，将set_wt放入set_wt_lst中，set_wt设置为空，对当前节点重复4操作
7. 当前颜色已经无法增加新的课程，将当前颜色的节点从set_cpl中移除，并在邻接矩阵中相应的行列均标记为某特殊值，代表后续不再考虑，清空set_wt_lst。如果set_cpl不为空,重复步骤2，否则，排课完成



![New Doc 2017-12-10_2](../../../../Downloads/New Doc 2017-12-10_2.jpg)























